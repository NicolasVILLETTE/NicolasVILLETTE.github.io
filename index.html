<html>
	
<head>

<meta charset="utf-8" />
<script src="https://unpkg.com/pdf-lib@1.4.0"></script>
<script src="https://unpkg.com/downloadjs@1.4.7"></script>
<script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>
<script src="https://code.jquery.com/jquery-3.1.1.min.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>

</head>

  <body>
	  
	  
<div class="ui placeholder segment">
	
<div>
<canvas id="signature_canvas" width=500 height=240 aria-describedby="help-signature"></canvas>
</div>

</div>
	  
<button class="ui button" onclick="modifyPdf()>Télécharger</button>


	

	  
	  
	    </body>

  <script>
	  console.log("7");
	  
	  	var canvas = document.querySelector("canvas");
	var signaturePad = new SignaturePad(canvas, { minWidth: 1, maxWidth: 3 });
	  
	  
	  
	  
	  
    const { degrees, PDFDocument, rgb, StandardFonts } = PDFLib
    
    


    async function modifyPdf() {
      // Fetch an existing PDF document
      const url = '/certificate.pdf'
  		const existingPdfBytes = await fetch(url).then(res => res.arrayBuffer())

      // Load a PDFDocument from the existing PDF bytes
      const pdfDoc = await PDFDocument.load(existingPdfBytes)

      // Embed the Helvetica font
      const helveticaFont = await pdfDoc.embedFont(StandardFonts.Helvetica)

      // Get the first page of the document
      const pages = pdfDoc.getPages()
      const firstPage = pages[0]

      // Get the width and height of the first page
      const { width, height } = firstPage.getSize()
      
      console.log(width);
      console.log(height);

      // Draw a string of text diagonally across the first page
      firstPage.drawText('X', {
        x: 175,
        y: 439,
        size: 15
      })
	    
	firstPage.drawText('AGNUS', {
	x: 100,
	y: 676,
	size: 15
	})
	    
	firstPage.drawText('Nicolas', {
	x: 100,
	y: 655,
	size: 15
	})
	    
	firstPage.drawText('1CL', {
	x: 100,
	y: 630,
	size: 15
	})
	    
	firstPage.drawText('SK', {
	x: 100,
	y: 605,
	size: 15
	})

      // Serialize the PDFDocument to bytes (a Uint8Array)
      const pdfBytes = await pdfDoc.save()

			// Trigger the browser to download the PDF document
      download(pdfBytes, "pdf-lib_modification_example.pdf", "application/pdf");
    }
  </script>
</html>
